{"remainingRequest":"D:\\projects\\beike\\pinda-authority-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\projects\\beike\\pinda-authority-ui\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\projects\\beike\\pinda-authority-ui\\src\\api\\AxiosApi.js","dependencies":[{"path":"D:\\projects\\beike\\pinda-authority-ui\\src\\api\\AxiosApi.js","mtime":1585207882475},{"path":"D:\\projects\\beike\\pinda-authority-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\projects\\beike\\pinda-authority-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\projects\\beike\\pinda-authority-ui\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:\\\\projects\\\\beike\\\\pinda-authority-ui\\\\node_modules\\\\@babel\\\\runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es7.object.entries\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nvar _objectSpread2 = _interopRequireDefault(require(\"D:\\\\projects\\\\beike\\\\pinda-authority-ui\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/objectSpread2\"));\n\nrequire(\"core-js/modules/es7.array.includes\");\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _elementUi = require(\"element-ui\");\n\nvar _localstorage = _interopRequireDefault(require(\"@/utils/localstorage\"));\n\n// 请求添加条件，如token\n_axios.default.interceptors.request.use(function (config) {\n  config.headers.token = _localstorage.default.get('TOKEN', '');\n  config.headers.tenant = _localstorage.default.get('TENANT', '');\n  return config;\n}, function (error) {\n  return Promise.reject(error);\n}); // 接口返回处理\n\n\n_axios.default.interceptors.response.use(function (response) {\n  return response;\n}, function (error) {\n  return Promise.reject(error);\n});\n\nfunction handleError(error, reject) {\n  debugger;\n\n  if (error.code === 'ECONNABORTED') {\n    (0, _elementUi.Message)({\n      message: '请求超时'\n    });\n  } else if (error.response && error.response.data) {\n    (0, _elementUi.Message)({\n      message: error.response.data\n    });\n  } else if (error.message) {\n    (0, _elementUi.Message)({\n      message: error.message\n    });\n  }\n\n  reject(error);\n}\n\nfunction handleSuccess(res, resolve) {\n  if (res.data.isError) {\n    // 未登录\n    if (res.data.code === 40001) {\n      debugger;\n\n      _elementUi.MessageBox.alert(res.data.msg, '提醒', {\n        confirmButtonText: '确定',\n        callback: function callback() {\n          debugger;\n          window.location.hash = '/login';\n        }\n      });\n    } else {\n      _elementUi.Message.error(res.data.msg);\n    }\n  }\n\n  resolve(res);\n} // http请求\n\n\nvar httpServer = function httpServer(opts) {\n  // 公共参数\n  var publicParams = {\n    ts: Date.now()\n  }; // http默认配置\n\n  var method = opts.method.toUpperCase(); // baseURL\n  // 开发环境： /api                 // 开发环境在 vue.config.js 中有 devServer.proxy 代理\n  // 生产环境： http://IP:PORT/api   // 生产环境中 代理失效， 故需要配置绝对路径\n\n  var httpDefaultOpts = {\n    method: method,\n    baseURL: process.env.VUE_APP_PROD_REQUEST_DOMAIN_PREFIX + process.env.VUE_APP_BASE_API,\n    url: opts.url,\n    responseType: opts.responseType || '',\n    timeout: 20000\n  };\n  var dataRequest = ['PUT', 'POST', 'PATCH'];\n\n  if (dataRequest.includes(method)) {\n    httpDefaultOpts.data = opts.data || {};\n  } else {\n    httpDefaultOpts.params = (0, _objectSpread2.default)({}, publicParams, {}, opts.data || {});\n  } // formData转换\n\n\n  if (opts.formData) {\n    httpDefaultOpts.transformRequest = [function (data) {\n      var formData = new FormData();\n\n      if (data) {\n        Object.entries(data).forEach(function (item) {\n          formData.append(item[0], item[1]);\n        });\n      }\n\n      return formData;\n    }];\n  }\n\n  var promise = new Promise(function (resolve, reject) {\n    (0, _axios.default)(httpDefaultOpts).then(function (response) {\n      handleSuccess(response, resolve);\n    }).catch(function (error) {\n      handleError(error, reject);\n    });\n  });\n  return promise;\n};\n\nvar _default = httpServer;\nexports.default = _default;",null]}