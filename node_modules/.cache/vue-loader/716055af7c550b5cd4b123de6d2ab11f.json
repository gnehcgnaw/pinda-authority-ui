{"remainingRequest":"D:\\品达通用权限系统\\资料\\前端工程\\pinda-authority-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\品达通用权限系统\\资料\\前端工程\\pinda-authority-ui\\src\\views\\iframe\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\品达通用权限系统\\资料\\前端工程\\pinda-authority-ui\\src\\views\\iframe\\index.vue","mtime":1585207882856},{"path":"D:\\品达通用权限系统\\资料\\前端工程\\pinda-authority-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\品达通用权限系统\\资料\\前端工程\\pinda-authority-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\品达通用权限系统\\资料\\前端工程\\pinda-authority-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\品达通用权限系统\\资料\\前端工程\\pinda-authority-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      src: '',\r\n      urlPath: this.getUrlPath() //iframe src 路径\r\n    }\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    $route: function() {\r\n      this.load()\r\n    },\r\n    routerPath: function() {\r\n      // 监听routerPath变化，改变src路径\r\n      this.urlPath = this.getUrlPath()\r\n      alert(this.urlPath)\r\n    }\r\n  },\r\n  created() {},\r\n  mounted() {\r\n    this.load()\r\n    this.resize()\r\n  },\r\n  methods: {\r\n    resize() {\r\n      window.onresize = () => {\r\n        this.iframeInit()\r\n      }\r\n    },\r\n    load() {\r\n      var flag = true //URL是否包含问号\r\n      if (\r\n        this.$route.query.src !== undefined &&\r\n        this.$route.query.src.indexOf('?') === -1\r\n      ) {\r\n        flag = false\r\n      }\r\n      var list = []\r\n      for (var key in this.$route.query) {\r\n        if (key !== 'src' && key !== 'name' && key !== 'i18n') {\r\n          list.push(`${key}= this.$route.query[key]`)\r\n        }\r\n      }\r\n      list = list.join('&').toString()\r\n      if (flag) {\r\n        this.$route.query.src = `${this.$route.query.src}${\r\n          list.length > 0 ? `&list` : ''\r\n        }`\r\n      } else {\r\n        this.$route.query.src = `${this.$route.query.src}${\r\n          list.length > 0 ? `?list` : ''\r\n        }`\r\n      }\r\n      //超时3s自动隐藏等待狂，加强用户体验\r\n      let time = 3\r\n      const timeFunc = setInterval(() => {\r\n        time--\r\n        if (time === 0) {\r\n          clearInterval(timeFunc)\r\n        }\r\n      }, 1000)\r\n      this.iframeInit()\r\n      this.src = this.getUrlPath()\r\n    },\r\n    iframeInit() {\r\n      const iframe = this.$refs.iframe\r\n      const clientHeight =\r\n        document.documentElement.clientHeight - (screen > 1 ? 200 : 130)\r\n      if (!iframe) return\r\n      iframe.style.height = `${clientHeight}px`\r\n      if (iframe.attachEvent) {\r\n        iframe.attachEvent('onload', () => {})\r\n      } else {\r\n        iframe.onload = () => {}\r\n      }\r\n    },\r\n    getUrlPath: function() {\r\n      console.log(this.$route)\r\n      //获取 iframe src 路径\r\n      let url = decodeURIComponent(window.location.href)\r\n      let urlH = ''\r\n      if (window.location.port) {\r\n        urlH = window.location.protocol + '//' + window.location.host + '/#'\r\n      } else {\r\n        urlH = window.location.protocol + '//' + window.location.hostname + '/#'\r\n      }\r\n      url = url.replace(urlH + '/myiframe/iframe?urlPath&src=', '')\r\n      return url\r\n    }\r\n  }\r\n}\r\n",null]}